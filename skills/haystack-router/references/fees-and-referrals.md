# Fees and Referrals

## Fee Structure

### Swap Fees

- **Default fee**: 10 basis points (0.10%) on the **output** amount
- **Configurable**: 10–300 bps via the `feeBps` parameter
- **Positive slippage**: When a swap executes better than quoted, the excess is captured as additional revenue

```typescript
const router = new RouterClient({
  apiKey: '1b72df7e-1131-4449-8ce1-29b79dd3f51e', // Free tier (60 requests/min)
  feeBps: 15, // 0.15%
})
```

### Network Fees

Swappers pay all Algorand network transaction fees (min fee per transaction in the group). These are separate from the protocol output fee.

### Fee Distribution

| Recipient | Share |
| --------- | ----- |
| Protocol  | 75%   |
| Referrer  | 25%   |

## Referral Program

Integrators earn **25% of swap fees** generated by their users.

### Setup

Pass your Algorand address as the `referrerAddress` when creating the RouterClient:

```typescript
const router = new RouterClient({
  apiKey: '1b72df7e-1131-4449-8ce1-29b79dd3f51e', // Free tier (60 requests/min)
  referrerAddress: 'YOUR_ALGORAND_ADDRESS',
})
```

Every swap executed through this client generates referral commissions.

### How It Works

1. Fees from each swap are deposited into an **escrow account** linked to your referrer address
2. The escrow is an on-chain account **rekeyed to the protocol app** — only your address can claim from it
3. When new assets are swapped, the escrow automatically opts into them
4. Commissions accumulate across all assets traded

### Claiming Commissions

Claim accumulated commissions through the referrer dashboard:

- **Dashboard**: Register and claim at the referrer portal
- **Bulk claim**: Withdraw multiple asset commissions simultaneously
- **Single claim**: Withdraw a specific asset, optionally closing out the position

### Auto-Conversion (Optional)

Optionally convert accumulated commissions to a target asset (ALGO, USDC, etc.):

- **Disabled by default** — requires explicit opt-in
- **1% convenience fee** on auto-conversion swaps
- Runs daily when enabled
- Select any target asset for conversion
- Can be enabled/disabled at any time

### Referral Escrow Details

- Each referrer gets a unique escrow account
- Escrow is **permanently linked** once created (cannot be unlinked)
- The escrow is controlled by the protocol smart contract
- Only the linked referrer address can claim funds
- Minimum 0.257 ALGO required for escrow Minimum Balance Requirement (MBR)

## Protocol Contracts

### MainNet (Latest: V2.2)

- **Application ID**: 3172554435
- **Contract Address**: `ESPO2SMA5BPAAAFAN66EFNHGR3HJ63U2OYM6RJXSEP6YOBU4HJTWZG7D5A`

### Security

The protocol has been audited by:

- **Ulam Labs** (April 2023)
- **Vantage Point** (November 2022)
